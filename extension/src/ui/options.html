<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>DubFusion Options</title>
  <style>
    body { font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 16px; max-width: 720px; }
    h1 { font-size: 18px; margin-bottom: 12px; }
    h2 { font-size: 16px; margin: 20px 0 12px; color: #333; }
    label { display:block; font-weight:600; margin:12px 0 6px; }
    input[type="text"], select { width:100%; padding:8px; border:1px solid #ccc; border-radius:8px; }
    textarea { width:100%; height:200px; padding:8px; border:1px solid #ccc; border-radius:8px; font-family: monospace; font-size: 12px; resize: vertical; }
    .actions { margin-top:16px; display:flex; gap:8px; align-items: center; }
    button { padding:8px 12px; border-radius:8px; border:1px solid #ccc; cursor:pointer; background: #fff; }
    button:hover { background: #f5f5f5; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    #status { font-size:12px; opacity:.8; }
    .error { color: #d32f2f; font-weight: 500; }
    .success { color: #2e7d32; font-weight: 500; }
    .summary { background: #f5f5f5; padding: 12px; border-radius: 8px; margin-top: 12px; font-size: 13px; }
    .summary strong { color: #333; }
    .help-text { font-size: 12px; color: #666; margin-top: 4px; }
  </style>
</head>
<body>
  <h1>DubFusion Options</h1>
  
  <h2>TTS Provider</h2>
  <label for="ttsProvider">Text-to-Speech Provider</label>
  <select id="ttsProvider">
    <option value="browser">Browser TTS (Web Speech API)</option>
    <option value="elevenlabs">ElevenLabs (Cloud TTS)</option>
  </select>
  <div class="help-text">Choose the text-to-speech provider. Browser TTS is free but limited, ElevenLabs offers higher quality voices.</div>

  <div id="elevenlabsSection" style="display: none;">
    <h2>ElevenLabs Settings</h2>
    
    <label for="elevenlabsApiKey">API Key</label>
    <input id="elevenlabsApiKey" type="password" placeholder="sk_..." />
    <div class="help-text">Your ElevenLabs API key. Stored securely in local storage.</div>
    
    <label for="elevenlabsModelId">Model ID</label>
    <input id="elevenlabsModelId" type="text" placeholder="eleven_multilingual_v2" value="eleven_multilingual_v2" />
    <div class="help-text">ElevenLabs model to use for text-to-speech.</div>
    
    <label for="elevenlabsVoiceId">Voice ID</label>
    <input id="elevenlabsVoiceId" type="text" placeholder="21m00Tcm4TlvDq8ikWAM" />
    <div class="help-text">Voice ID for the selected voice. Use "List Voices" to find available voices.</div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0;">
      <div>
        <label for="elevenlabsStability">Stability</label>
        <input id="elevenlabsStability" type="range" min="0" max="1" step="0.01" value="0.5" />
        <span id="stabilityValue">0.5</span>
        <div class="help-text">Voice stability (0-1). Higher values = more consistent.</div>
      </div>
      
      <div>
        <label for="elevenlabsSimilarityBoost">Similarity Boost</label>
        <input id="elevenlabsSimilarityBoost" type="range" min="0" max="1" step="0.01" value="0.75" />
        <span id="similarityBoostValue">0.75</span>
        <div class="help-text">Similarity to original voice (0-1). Higher values = more similar.</div>
      </div>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 16px 0;">
      <div>
        <label for="elevenlabsStyle">Style (Optional)</label>
        <input id="elevenlabsStyle" type="range" min="0" max="1" step="0.01" value="0" />
        <span id="styleValue">0</span>
        <div class="help-text">Style strength (0-1). Only for models that support it.</div>
      </div>
      
      <div>
        <label for="elevenlabsUseSpeakerBoost">Use Speaker Boost</label>
        <input id="elevenlabsUseSpeakerBoost" type="checkbox" />
        <div class="help-text">Enable speaker boost for enhanced clarity.</div>
      </div>
    </div>
    
    <div class="actions">
      <button id="listVoices">List Voices</button>
      <button id="testElevenLabs">ðŸ”Š Test ElevenLabs</button>
      <button id="debugStorage" style="background-color: #6c757d;">Debug Storage</button>
      <span id="elevenlabsStatus"></span>
    </div>
    
    <div id="voicesList" style="display: none; margin-top: 16px;">
      <h3>Available Voices</h3>
      <div id="voicesListContent" style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 8px; border-radius: 4px;"></div>
    </div>
  </div>

  <h2>Transcript Mode</h2>
  <label for="transcriptMode">Source</label>
  <select id="transcriptMode">
    <option value="manual">Manual (paste JSON transcript)</option>
    <option value="auto">Auto (YouTube captions)</option>
  </select>
  <div class="help-text">Choose how DubFusion gets transcript data. Manual mode lets you paste pre-built JSON transcripts.</div>

  <h2>Manual Transcript</h2>
  <label for="videoId">YouTube Video ID</label>
  <input id="videoId" type="text" placeholder="e.g., dQw4w9WgXcQ" />
  <div class="help-text">Enter the YouTube video ID (the part after v= in the URL). If left empty, will try to detect from current tab.</div>
  
  <label for="transcriptJson">JSON Transcript</label>
  <textarea id="transcriptJson" placeholder='Paste your JSON transcript here...
Example format:
{
  "title": "Video Title",
  "captions": [
    {"start": "0.16", "dur": "1.84", "text": "Hello world"},
    {"start": "2.0", "dur": "2.16", "text": "This is a test"}
  ]
}'></textarea>
  <div class="help-text">Paste a JSON object with title and captions array. Each caption needs start time, duration (dur), and text fields.</div>

  <div class="actions">
    <button id="validate">Validate</button>
    <button id="save" disabled>Save Transcript</button>
    <span id="status"></span>
  </div>

  <div id="summary" class="summary" style="display: none;"></div>

  <script src="options.js"></script>
</body>
</html>
